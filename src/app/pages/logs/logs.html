<div id="logsUsersTable" class="overflow-x-auto p-10">
  
  <div class="flex justify-between items-center mb-5">
    <h1 class="text-4xl font-bold text-info-content">Logs</h1>
    
    <div class="flex gap-3">
      <button (click)="exportToExcel()" class="btn bg-green-600 text-white border-none hover:bg-green-700 btn-md btn-outline gap-2">
        <ng-icon class="text-xl gap-2" name="ionDownloadOutline"></ng-icon>
        Exportar a Excel
      </button>
      <button (click)="logout()" class="btn bg-gray-600 text-white border-none hover:bg-gray-800 btn-md btn-outline gap-2">

          <ng-icon class="text-xl gap-2" name="ionLogOutOutline"></ng-icon>
        Log out
      </button>

      <div class="drawer">
        <input id="my-drawer-1" type="checkbox" class="drawer-toggle" />
        <div class="drawer-content">
          <label for="my-drawer-1" class="btn drawer-button text-3xl "> ≡</label>
        </div>
        <div class="drawer-side">
          <label for="my-drawer-1" aria-label="close sidebar" class="drawer-overlay "></label>
          <ul class="menu bg-base-200 min-h-full w-80 p-5 gap-3 ">
           <li class="text-2xl font-bold border-b-1 border-gray-300" ><a [routerLink]="'/tests'">Tests</a></li>
           <li class="text-2xl font-bold border-b-1 border-gray-300"><a [routerLink]="'/logs-users'">Logs Users</a></li>
           <li class="text-2xl font-bold border-b-1 border-gray-300"><a [routerLink]="'/prueba'">Prueba</a></li>
          </ul>
        </div>
      </div>

    </div>
  </div>

  <div class="mb-5 space-y-4">

    <div class="flex flex-wrap gap-3 mt-6 items-end">
      <div class="flex gap-2 items-end">
        <label class="form-control">
          <div class="label">
            <span class="label-text text-sm">Fecha inicio</span>
          </div>
          <input 
            type="date" 
            class="input input-sm input-bordered ml-3 w-40"
            [(ngModel)]="startDate"
            (change)="onDateChange()"
          />
        </label>
        
        <label class="form-control">
          <div class="label">
            <span class="label-text ml-3 text-sm">Fecha fin</span>
          </div>
          <input 
            type="date" 
            class="input input-sm input-bordered ml-3 w-40"
            [(ngModel)]="endDate"
            (change)="onDateChange()"
          />
        </label>
      </div>
      <select 
        class="select select-sm w-40" 
        [(ngModel)]="selectedPage" 
        (change)="onPageSelect($event)"
        [disabled]="availablePages.length === 0"
      >
        <option value="" disabled selected>Número de página</option>
        <option *ngFor="let page of availablePages" [value]="page">
          Página {{ page }}
        </option>
      </select>

      <div class="flex gap-2">
        <button 
          (click)="clearDateFilters()" 
          class="btn btn-sm bg-gray-600 text-white border-none hover:bg-gray-700"
        >
          Limpiar filtros
        </button>
      </div>
    </div>
    <div class="text-center " *ngIf="loading">
      <span class="loading loading-ring loading-6xl"></span>
    </div>
    <div class="text-center p-10" *ngIf="!loading && totalLogsCount === 0 && (!startDate || !endDate)">
      <p class="text-2xl text-gray-500">Seleccione un rango de fechas para ver los logs</p>
    </div>
    <div class="text-center p-10" *ngIf="!loading && totalLogsCount === 0 && startDate && endDate">
      <p class="text-2xl text-gray-500">No se encontraron logs para el rango de fechas seleccionado</p>
    </div>
  </div>

  
  <div class="min-h-[600px]">
    <table *ngIf="paginatedLogs?.length" class="table table-md w-full">
      <thead>
        <tr>
          <th class="text-2xl text-info-content text-center">Posición</th>
          <th class="text-2xl text-info-content text-center">Hora</th>
          <th class="text-2xl text-info-content text-center">Fecha</th>
          <th class="text-2xl text-info-content text-center">Tipo de Log</th>
          <th class="text-2xl text-info-content ">Contenido</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let log of paginatedLogs; let i = index">
          <td class="text-xl text-center">{{ log.id }}</td>
          <td class="text-xl text-center">{{ log.time }}</td>
          <td class="text-xl text-center">{{ log.date }}</td>
          <td class="text-xl text-center">
            <span [ngClass]="getLogLevelClass(log.logLevel)" class="badge badge-lg font-semibold">
              {{ log.logLevel }}
            </span>
          </td>
          <td class="text-xl">
            <div class="collapse collapse-arrow bg-base-200">
              <input type="checkbox" name="accordion-{{ log.id }}" />
              <div class="collapse-title text-xl font-medium">
                {{ log.content.length > 80 ? (log.content.substring(0, 80) + '...') : log.content }}
              </div>
              <div class="collapse-content">
                <p class="whitespace-pre-wrap break-words ">{{ log.content }}</p>
              </div>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <nav *ngIf="totalLogsCount > 0" class="flex  w-auto items-center flex-col md:flex-row justify-between p-4 pt-4 mt-3 border-t bg-gray-800  shadow-md rounded-md" aria-label="Table navigation">
    <span class="text-sm font-normal text-white text-body mb-4 md:mb-0 block w-full md:inline md:w-auto">
        Mostrando página <span class="font-semibold text-white ">{{ currentPage }}</span> de <span class="font-semibold text-heading">{{ totalPages }}</span> (Total: {{ totalLogsCount }} logs)
    </span>
    <ul class="flex space-x-1 text-sm justify-center text-white">
        <li>
            <button (click)="prevPage()" [disabled]="currentPage === 1" [class.opacity-50]="currentPage === 1" class="flex items-center justify-center text-body  border-default-medium hover:bg-neutral-tertiary-medium hover:text-heading font-medium rounded-full text-sm px-3 h-9 transition-colors duration-200 transform hover:scale-105 active:scale-95 shadow-sm shadow-white focus:ring-2 focus:ring-brand focus:outline-none disabled:cursor-not-allowed disabled:opacity-50">Previous</button>
        </li>
        <li *ngFor="let page of getPageNumbers()">
            <button *ngIf="page !== '...'" (click)="goToPage($any(page))" [class.text-fg-brand]="page === currentPage" [class.bg-brand-softer]="page === currentPage" [class.bg-neutral-secondary-medium]="page !== currentPage" class="flex items-center justify-center text-body hover:bg-neutral-tertiary-medium hover:text-heading font-medium rounded-full text-sm w-9 h-9 transition-colors duration-200 transform hover:scale-105 active:scale-95 shadow-sm shadow-white focus:ring-2 focus:ring-brand focus:outline-none">
                {{ page }}
            </button>
            <span *ngIf="page === '...'" class="flex items-center justify-center text-body bg-neutral-secondary-medium  font-medium rounded-full text-sm w-9 h-9">...</span>
        </li>
        <li>
            <button (click)="nextPage()" [disabled]="currentPage === totalPages" [class.opacity-50]="currentPage === totalPages" class="flex items-center justify-center text-body bg-neutral-secondary-medium  hover:bg-neutral-tertiary-medium hover:text-heading font-medium rounded-full text-sm px-3 h-9 transition-colors duration-200 transform hover:scale-105 active:scale-95 shadow-sm shadow-white focus:ring-2 focus:ring-brand focus:outline-none disabled:cursor-not-allowed disabled:opacity-50">Next</button>
        </li>
    </ul>
  </nav>
</div>