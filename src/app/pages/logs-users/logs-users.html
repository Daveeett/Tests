<div id="logsUsersTable" class="overflow-x-auto p-10">
  
  <div class="flex justify-between items-center mb-5">
    <h1 class="text-4xl font-bold text-info-content">Logs de Usuarios</h1>
    <div class="flex gap-3">
      <button (click)="exportToExcel()" class="btn bg-green-600 text-white border-none hover:bg-green-700 btn-md btn-outline gap-2">
        <ng-icon class="text-xl gap-2" name="ionDownloadOutline"></ng-icon>
        Exportar a Excel
      </button>
      <button (click)="logout()" class="btn bg-gray-600 text-white border-none hover:bg-gray-800 btn-md btn-outline gap-2">

          <ng-icon class="text-xl gap-2" name="ionLogOutOutline"></ng-icon>
        Log out
      </button>
    </div>
  </div>

  <div class="mb-5 space-y-4">
    <label class="input input-sm flex items-center gap-2 max-w-md">
      <ng-icon class="text-xl gap-2" name="ionSearch"></ng-icon>
      <input 
        type="text" 
        class="grow" 
        placeholder="Buscar por nombre de usuario..." 
        [(ngModel)]="searchTerm"
        (input)="onSearchChange()"
      />
    </label>

    <div class="flex flex-wrap gap-3 mt-6 items-end">
      <div class="flex gap-2 items-end">
        <label class="form-control">
          <div class="label">
            <span class="label-text text-sm">Fecha inicio</span>
          </div>
          <input 
            type="date" 
            class="input input-sm input-bordered ml-3 w-40"
            [(ngModel)]="startDate"
            (change)="onDateChange()"
          />
        </label>
        
        <label class="form-control">
          <div class="label">
            <span class="label-text ml-3 text-sm">Fecha fin</span>
          </div>
          <input 
            type="date" 
            class="input input-sm input-bordered ml-3 w-40"
            [(ngModel)]="endDate"
            (change)="onDateChange()"
          />
        </label>
      </div>

      <div class="flex gap-2">
        <button 
          (click)="filterToday()" 
          class="btn btn-sm bg-blue-600 text-white border-none hover:bg-blue-700"
        >
          Hoy
        </button>
        <button 
          (click)="filterLastWeek()" 
          class="btn btn-sm bg-blue-600 text-white border-none hover:bg-blue-700"
        >
          Últimos 7 días
        </button>
        <button 
          (click)="filterLast30Days()" 
          class="btn btn-sm bg-blue-600 text-white border-none hover:bg-blue-700"
        >
          Últimos 30 días
        </button>
        <button 
          (click)="clearDateFilters()" 
          class="btn btn-sm bg-gray-600 text-white border-none hover:bg-gray-700"
        >
          Limpiar filtros
        </button>
      </div>
    </div>
  </div>

  
  <div class="min-h-[600px]">
    <table *ngIf="paginatedLogs?.length" class="table table-md w-full">
      <thead>
        <tr>
          <th class="text-2xl text-info-content">User</th>
          <th class="text-2xl text-info-content">User IP</th>
          <th class="text-2xl text-info-content">Login Time</th>
        </tr>
      </thead>
      <tbody >
        <tr  *ngFor="let log of paginatedLogs">
          
          <td class="text-xl ">{{ log.userName }}</td>
          <td class="text-xl ">{{ log.userIp }}</td>
          <td class="text-xl ">{{ log.loginTime | date:'medium' }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <nav *ngIf="(filteredLogs?.length || 0) > 0" class="flex  w-auto items-center flex-col md:flex-row justify-between p-4 pt-4 mt-3 border-t bg-gray-800  shadow-md rounded-md" aria-label="Table navigation">
    <span class="text-sm font-normal text-white text-body mb-4 md:mb-0 block w-full md:inline md:w-auto">
        Showing <span class="font-semibold text-white ">{{ (currentPage - 1) * itemsPerPage + 1 }}-{{ currentPage * itemsPerPage > filteredLogs.length ? filteredLogs.length : currentPage * itemsPerPage }}</span> of <span class="font-semibold text-heading">{{ filteredLogs.length }}</span>
    </span>
    <ul class="flex space-x-1 text-sm justify-center text-white">
        <li>
            <button (click)="prevPage()" [disabled]="currentPage === 1" [class.opacity-50]="currentPage === 1" class="flex items-center justify-center text-body  border-default-medium hover:bg-neutral-tertiary-medium hover:text-heading font-medium rounded-full text-sm px-3 h-9 transition-colors duration-200 transform hover:scale-105 active:scale-95 shadow-sm shadow-white focus:ring-2 focus:ring-brand focus:outline-none disabled:cursor-not-allowed disabled:opacity-50">Previous</button>
        </li>
        <li *ngFor="let page of getPageNumbers()">
            <button *ngIf="page !== '...'" (click)="goToPage($any(page))" [class.text-fg-brand]="page === currentPage" [class.bg-brand-softer]="page === currentPage" [class.bg-neutral-secondary-medium]="page !== currentPage" class="flex items-center justify-center text-body hover:bg-neutral-tertiary-medium hover:text-heading font-medium rounded-full text-sm w-9 h-9 transition-colors duration-200 transform hover:scale-105 active:scale-95 shadow-sm shadow-white focus:ring-2 focus:ring-brand focus:outline-none">
                {{ page }}
            </button>
            <span *ngIf="page === '...'" class="flex items-center justify-center text-body bg-neutral-secondary-medium  font-medium rounded-full text-sm w-9 h-9">...</span>
        </li>
        <li>
            <button (click)="nextPage()" [disabled]="currentPage === totalPages" [class.opacity-50]="currentPage === totalPages" class="flex items-center justify-center text-body bg-neutral-secondary-medium  hover:bg-neutral-tertiary-medium hover:text-heading font-medium rounded-full text-sm px-3 h-9 transition-colors duration-200 transform hover:scale-105 active:scale-95 shadow-sm shadow-white focus:ring-2 focus:ring-brand focus:outline-none disabled:cursor-not-allowed disabled:opacity-50">Next</button>
        </li>
    </ul>
  </nav>
</div>